### JS的作用域

> JS是词法作用域，而且

1. **JavaScript没有块级作用域**
2. **函数声明会覆盖变量声明，但不会覆盖变量赋值**
3. **函数声明会提升，函数表达式不会被提升**

说到作用域，JS的作用域链是作用域的根本，因为JS就是通过作用域链去搜索变量的

上面说到了词法作用域，其实跟作用域链息息相关。



> **作用域链其实就是所有内部上下文的变量对象的列表，可用于变量查询**



> **执行上下文：执行上下文（简称：EC）是个抽象的概念，一系列活动的执行上下文从逻辑上形成一个栈。栈底总是全局上下文，栈顶是当前（活动的）执行上下文。我的理解是当代码调用一个函数时就会在执行的栈里面推入该函数的执行上下文，执行完毕返回之后函数的执行上下文出栈便回到全局的执行上下文**
>
> JS中只有通过“函数代码”才能创建独立的作用域



JS的作用域链由两个阶段决定：函数创建和函数调用

- 函数创建时决定了内部的[[Scope]]属性，**[[Scope]]是一个包含了所有上层变量对象的分层链**，它属于当前函数上下文，并在函数创建的时候，保存在函数中。
- 函数调用时进入自身执行上下文，创建自己的活跃对象AO（包括参数，函数声明和变量声明），指定`this`的指向，并合成自身的作用域链（Scope = AO + [[Scope]]）

> 注意：通过new Function() 构造出来的函数内部的[[Scope]]只有全局上下文的变量对象。